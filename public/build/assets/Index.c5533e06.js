import{h as ue,u as b,j as M,m as V,n as J,a as e,b as i,w as a,F as me,r as c,o as m,H as pe,d as n,s as _,f as y,t as h,z as fe,c as f,q as _e,A as he}from"./app.cc606831.js";import{_ as be}from"./AuthenticatedLayout.0bc0b363.js";import{_ as ye}from"./DialogConfirm.f96873bf.js";import{_ as qe}from"./Summary.3f494b75.js";const ge={class:"row q-pb-sm"},ve={class:"column col-12 col-md-6 justify-center"},we=n("div",{class:"app-fs-28 app-fw-700 app-lh-32 text-grey-8"}," Comercial ",-1),xe={class:"row justify-end"},Ce={class:"row items-center"},ke={key:0,class:"row q-mb-lg"},Se={class:"col-12 flex justify-end items-end"},Me=n("div",{class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20"}," Adicionar Pedido ",-1),Ve={class:"row q-col-gutter-sm"},$e={class:"col-12"},ze={class:"col-12"},Be={class:"col-12"},Ie={class:"col-12"},Ne={class:"col-12"},Oe={class:"text-red"},Pe={class:"flex flex-center q-pt-lg q-pa-md q-gutter-sm"},Te=n("div",{class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20"}," Filtrar ",-1),Ae=n("div",{class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20 m-4"}," Limpar ",-1),Fe=["onClick"],Ue={class:"flex flex-center app-fw-700 app-fs-16"},je={class:"app-fw-700 app-fs-16"},Re=n("div",{class:"q-ml-sm"}," Editar pedido ",-1),Le=n("div",{class:"q-ml-sm"}," Visualizar pedido ",-1),De=n("div",{class:"q-ml-sm"}," Cancelar recorr\xEAncia ",-1),Ee=n("div",{class:"q-ml-sm"}," Visualizar ",-1),He={class:"row justify-end"},Je={class:"row items-center text-grey"},Xe={__name:"Index",props:{orders:Object,errors:Object,query:Object,paymentMethods:Object,statuses:Object,campaigns:Object,students:Array,ordersPaidCount:Number,ordersExpiredCount:Number,ordersCanceledCount:Number,ordersNotRenewedCount:Number,totalActiveStudentsCount:Number,newStudentsInSelectedMonthCount:Number,newStudentsInTheMonthBeforeTheSelectedMonthCount:Number,churnRateInSelectedMonth:Number,churnRateInTheMonthBeforeTheSelectedMonth:Number,canOrderCancel:Boolean,canOrderUpdate:Boolean,canOrderStore:Boolean,selectedMonth:Number},setup(s){const d=s,O=ue(),K=[{name:"student_id",align:"left",label:"ID do aluno",field:o=>o.student.id,style:"width: 5%"},{name:"student_name",align:"left",label:"Nome do aluno",field:o=>o.student.name,style:"width: 20%"},{name:"student_email",align:"left",label:"E-mail do aluno",field:o=>o.student.email,style:"width: 25%"},{name:"registration_type",align:"left",label:"Tipo de cadastro",field:o=>o.registration_type.replace(/^./,l=>l.toUpperCase()),style:"width: 15%"},{name:"payment_method",align:"left",label:"Forma de pagamento",field:o=>ee(o.payment_method),style:"width: 25%"},{name:"status",align:"left",label:"Status",field:"status",style:"width: 10%"},{name:"actions",label:"A\xE7\xE3o"}],r=b({orderBy:d.query.orderBy,sort:d.query.sort,page:d.query.page,rowsPerPage:d.query.rowsPerPage,filters:{payment_method:d.query.filters.payment_method,status:d.query.filters.status,hiring_start_at:d.query.filters.hiring_start_at,campaign_id:d.query.filters.campaign_id,student_id:d.query.filters.student_id,email:d.query.filters.email}}),Q=o=>{r.orderBy===o?r.sort=r.sort=="desc"?"asc":"desc":r.sort=="asc",r.orderBy=o,r.page=1,g()},q=o=>{r.filters[o]=null,g()},g=()=>{r.get(route("admin.commercial.index"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>$.value=!1})},G=o=>{O.dialog({component:ye,componentProps:{title:"Cancelar recorr\xEAncia?",message:"Tem certeza que deseja cancelar recorr\xEAncia?"}}).onOk(()=>{b().post(route("admin.order.cancel",o),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{O.notify({type:"positive",message:"Recorr\xEAncia cancelada com sucesso",position:"top"})}})})},W=()=>b().get(route("admin.order.create")),X=o=>b().get(route("admin.order.edit",o)),P=o=>b().get(route("admin.order.show",o)),T=M(()=>Object.values(d.query.filters).filter(o=>o).length),$=V(!1),A=M(()=>{let o=new Array;for(const l in d.paymentMethods)o.push({label:d.paymentMethods[l],value:l});return o}),F=M(()=>{let o=new Array;for(const l in d.statuses)o.push({label:d.statuses[l],value:l});return o}),U=V(d.campaigns),Y=(o,l,k)=>{l(()=>U.value=d.campaigns.filter(C=>C.name.toLowerCase().indexOf(o.toLowerCase())>-1))},j=V(d.students),Z=(o,l,k)=>{l(()=>j.value=d.students.filter(C=>C.name.toLowerCase().indexOf(o.toLowerCase())>-1))},ee=o=>d.paymentMethods[o],te=o=>d.statuses[o],ae=o=>{switch(o){case"adimplente":return"adm-bg-positive";case"cancelado":return"adm-bg-error";case"nao_renovou":return"adm-bg-negative";case"vencido":return"adm-bg-caution";default:return"bg-white"}},le=M(()=>[{value:1,label:"Janeiro"},{value:2,label:"Fevereiro"},{value:3,label:"Mar\xE7o"},{value:4,label:"Abril"},{value:5,label:"Maio"},{value:6,label:"Junho"},{value:7,label:"Julho"},{value:8,label:"Agosto"},{value:9,label:"Setembro"},{value:10,label:"Outubro"},{value:11,label:"Novembro"},{value:12,label:"Dezembro"}]),z=V(d.selectedMonth),oe=()=>{b({month:z.value}).get(route("admin.commercial.index"),{preserveState:!0,preserveScroll:!0})},se=()=>b().get(route("admin.commercial.index"));return(o,l)=>{const k=c("q-breadcrumbs-el"),C=c("q-breadcrumbs"),v=c("q-select"),u=c("q-icon"),w=c("q-btn"),p=c("q-chip"),S=c("q-card-section"),R=c("q-card"),L=c("q-input"),ne=c("q-space"),re=c("q-badge"),D=c("q-menu"),B=c("q-separator"),E=c("q-th"),H=c("q-td"),I=c("q-item-section"),N=c("q-item"),ie=c("q-list"),de=c("q-table"),ce=c("q-pagination");return m(),J(me,null,[e(i(pe),{title:"Comercial"}),e(be,null,{default:a(()=>[n("div",ge,[n("div",ve,[we,e(C,{class:"text-grey q-mt-sm app-fs-13 app-fw-400 app-lh-16",gutter:"xs"},{default:a(()=>[e(k,{label:"Home",class:"text-grey"}),e(k,{label:"Comercial",class:"text-primary"})]),_:1})])]),n("div",xe,[n("div",Ce,[e(v,{options:i(le),borderless:"","emit-value":"","map-options":"",modelValue:z.value,"onUpdate:modelValue":[l[0]||(l[0]=t=>z.value=t),oe],class:"q-mr-sm"},null,8,["options","modelValue"])])]),e(qe,{newStudentsInSelectedMonthCount:s.newStudentsInSelectedMonthCount,newStudentsInTheMonthBeforeTheSelectedMonthCount:s.newStudentsInTheMonthBeforeTheSelectedMonthCount,churnRateInSelectedMonth:s.churnRateInSelectedMonth,churnRateInTheMonthBeforeTheSelectedMonth:s.churnRateInTheMonthBeforeTheSelectedMonth,totalActiveStudentsCount:s.totalActiveStudentsCount},null,8,["newStudentsInSelectedMonthCount","newStudentsInTheMonthBeforeTheSelectedMonthCount","churnRateInSelectedMonth","churnRateInTheMonthBeforeTheSelectedMonth","totalActiveStudentsCount"]),s.canOrderStore?(m(),J("div",ke,[n("div",Se,[e(w,{color:"primary",rounded:"","no-caps":"",onClick:W},{default:a(()=>[e(u,{name:"add",size:"xs"}),Me]),_:1})])])):_("",!0),e(R,{flat:"",class:"app-br-16 q-pa-md q-mb-lg"},{default:a(()=>[e(S,{class:"flex flex-center q-py-sm"},{default:a(()=>[e(p,{class:"adm-bg-positive","text-color":"white"},{default:a(()=>[y(h(s.ordersPaidCount)+" Adimplentes ",1)]),_:1}),e(p,{class:"adm-bg-caution","text-color":"white"},{default:a(()=>[y(h(s.ordersExpiredCount)+" Vencidos ",1)]),_:1}),e(p,{class:"adm-bg-error","text-color":"white"},{default:a(()=>[y(h(s.ordersCanceledCount)+" Cancelados ",1)]),_:1}),e(p,{class:"adm-bg-negative","text-color":"white"},{default:a(()=>[y(h(s.ordersNotRenewedCount)+" N\xE3o renovados ",1)]),_:1})]),_:1})]),_:1}),e(R,{flat:"",class:"app-br-16 q-pa-sm q-mb-lg"},{default:a(()=>[e(S,{class:"row items-center q-py-sm q-px-lg"},{default:a(()=>[e(L,{outlined:"",modelValue:i(r).filters.email,"onUpdate:modelValue":l[1]||(l[1]=t=>i(r).filters.email=t),label:"Pesquisar por e-mail",dense:"",class:"q-mr-sm",onKeydown:fe(he(g,["prevent"]),["enter"])},{prepend:a(()=>[e(u,{name:"search",size:"xs"})]),_:1},8,["modelValue","onKeydown"]),s.query.filters.email?(m(),f(p,{key:0,class:"adm-chip-primary",label:`E-mail cont\xE9m '${s.query.filters.email}'`},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:l[2]||(l[2]=t=>q("email")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):_("",!0),s.query.filters.student_id?(m(),f(p,{key:1,class:"adm-chip-primary",label:`Aluno = ${s.students.filter(t=>t.id==s.query.filters.student_id).shift().name}`},{default:a(()=>[e(u,{name:"cancel",size:"s",onClick:l[3]||(l[3]=t=>q("student_id")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):_("",!0),s.query.filters.status?(m(),f(p,{key:2,class:"adm-chip-primary",label:`Status = ${i(F).filter(t=>t.value==s.query.filters.status).shift().label}`},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:l[4]||(l[4]=t=>q("status")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):_("",!0),s.query.filters.campaign_id?(m(),f(p,{key:3,class:"adm-chip-primary",label:`Campanha = ${s.campaigns.filter(t=>t.id==s.query.filters.campaign_id).shift().name}`},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:l[5]||(l[5]=t=>q("campaign_id")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):_("",!0),s.query.filters.payment_method?(m(),f(p,{key:4,class:"adm-chip-primary",label:`Forma de pagamento = ${i(A).filter(t=>t.value==s.query.filters.payment_method).shift().label}`},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:l[6]||(l[6]=t=>q("payment_method")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):_("",!0),s.query.filters.hiring_start_at?(m(),f(p,{key:5,class:"adm-chip-primary",label:`Data da contrata\xE7\xE3o em = ${s.query.filters.hiring_start_at}`},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:l[7]||(l[7]=t=>q("hiring_start_at")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):_("",!0),e(ne),e(w,{round:"",dense:"",flat:"",color:"primary"},{default:a(()=>[i(T)?(m(),f(re,{key:0,color:"primary",floating:"",rounded:"",label:i(T)},null,8,["label"])):_("",!0),e(u,{name:"tune",class:"rotate-90"}),e(D,{style:{"min-width":"500px"},"max-width":"500px",class:"bg-white q-pa-md app-br-16",modelValue:$.value,"onUpdate:modelValue":l[13]||(l[13]=t=>$.value=t)},{default:a(()=>[n("div",Ve,[n("div",$e,[e(v,{options:j.value,"option-value":"id","option-label":"name","emit-value":"","map-options":"",outlined:"",modelValue:i(r).filters.student_id,"onUpdate:modelValue":l[8]||(l[8]=t=>i(r).filters.student_id=t),label:"Aluno",clearable:"","use-chips":"","use-input":"",onFilter:Z},{"selected-item":a(t=>[e(p,{class:"adm-chip-primary q-my-none",label:t.opt.name,dense:""},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:x=>t.removeAtIndex(t.index),class:"q-ml-xs cursor-pointer"},null,8,["onClick"])]),_:2},1032,["label"])]),_:1},8,["options","modelValue"])]),n("div",ze,[e(v,{options:i(F),outlined:"",modelValue:i(r).filters.status,"onUpdate:modelValue":l[9]||(l[9]=t=>i(r).filters.status=t),label:"Status","emit-value":"","map-options":"",clearable:""},null,8,["options","modelValue"])]),n("div",Be,[e(v,{options:i(A),outlined:"",modelValue:i(r).filters.payment_method,"onUpdate:modelValue":l[10]||(l[10]=t=>i(r).filters.payment_method=t),label:"Forma de pagamento","emit-value":"","map-options":"",clearable:""},null,8,["options","modelValue"])]),n("div",Ie,[e(v,{options:U.value,"option-value":"id","option-label":"name","emit-value":"","map-options":"",outlined:"",modelValue:i(r).filters.campaign_id,"onUpdate:modelValue":l[11]||(l[11]=t=>i(r).filters.campaign_id=t),label:"Campanha",clearable:"","use-chips":"","use-input":"",onFilter:Y},{"selected-item":a(t=>[e(p,{class:"adm-chip-primary q-my-none",label:t.opt.name,dense:""},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:x=>t.removeAtIndex(t.index),class:"q-ml-xs cursor-pointer"},null,8,["onClick"])]),_:2},1032,["label"])]),_:1},8,["options","modelValue"])]),n("div",Ne,[e(L,{outlined:"",modelValue:i(r).filters.hiring_start_at,"onUpdate:modelValue":l[12]||(l[12]=t=>i(r).filters.hiring_start_at=t),mask:"##/##/####",label:"Data da contrata\xE7\xE3o",placeholder:"dia/m\xEAs/ano","bottom-slots":Boolean(s.errors["filters.hiring_start_at"])},{hint:a(()=>[n("div",Oe,h(s.errors["filters.hiring_start_at"]),1)]),prepend:a(()=>[e(u,{name:"o_calendar_today"})]),_:1},8,["modelValue","bottom-slots"])])]),n("div",Pe,[e(w,{color:"primary",rounded:"","no-caps":"",onClick:g},{default:a(()=>[e(u,{name:"check",size:"xs"}),Te]),_:1}),e(w,{color:"primary",rounded:"",outline:"","no-caps":"",onClick:se},{default:a(()=>[e(u,{name:"close",size:"xs"}),Ae]),_:1})])]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(S,{class:"q-py-none"},{default:a(()=>[e(B,{color:"grey-3"})]),_:1}),e(S,{class:"q-py-none"},{default:a(()=>[e(de,{rows:s.orders.data,columns:K,flat:"",class:"text-grey-8","hide-pagination":"",pagination:{rowsPerPage:i(r).rowsPerPage}},{"header-cell":a(t=>[e(E,{props:t},{default:a(()=>[n("div",{class:"app-fw-700 app-fs-16 cursor-pointer",onClick:x=>Q(t.col.name)},[y(h(t.col.label)+" ",1),t.col.name===s.query.orderBy?(m(),f(u,{key:0,name:s.query.sort=="desc"?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["name"])):_("",!0)],8,Fe)]),_:2},1032,["props"])]),"header-cell-actions":a(t=>[e(E,{props:t,"auto-width":""},{default:a(()=>[n("div",Ue,h(t.col.label),1)]),_:2},1032,["props"])]),"body-cell-status":a(t=>[e(H,{props:t},{default:a(()=>[e(p,{"text-color":"white",class:_e(ae(t.row.status))},{default:a(()=>[y(h(te(t.row.status)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-actions":a(t=>[e(H,{props:t},{default:a(()=>[n("div",je,[s.canOrderUpdate||s.canOrderCancel?(m(),f(w,{key:0,icon:"more_vert",flat:""},{default:a(()=>[e(D,null,{default:a(()=>[e(ie,null,{default:a(()=>[s.canOrderUpdate?(m(),f(N,{key:0,clickable:"",onClick:x=>X(t.row.id),class:"text-grey-7 flex items-center"},{default:a(()=>[e(u,{name:"edit",size:"xs"}),e(I,{"no-wrap":""},{default:a(()=>[Re]),_:1})]),_:2},1032,["onClick"])):_("",!0),e(B),e(N,{clickable:"",onClick:x=>P(t.row.id),class:"text-grey-7 flex items-center"},{default:a(()=>[e(u,{name:"visibility",size:"xs"}),e(I,{"no-wrap":""},{default:a(()=>[Le]),_:1})]),_:2},1032,["onClick"]),e(B),s.canOrderCancel?(m(),f(N,{key:1,clickable:"",onClick:x=>G(t.row.id),class:"text-grey-7 flex flex-center"},{default:a(()=>[e(u,{name:"close",size:"xs"}),e(I,{"no-wrap":""},{default:a(()=>[De]),_:1})]),_:2},1032,["onClick"])):_("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(m(),f(w,{key:1,onClick:x=>P(t.row.id),class:"text-grey-7 flex flex-center text-no-wrap",flat:"","no-caps":""},{default:a(()=>[e(u,{name:"visibility",size:"xs"}),Ee]),_:2},1032,["onClick"]))])]),_:2},1032,["props"])]),_:1},8,["rows","pagination"])]),_:1}),n("div",He,[n("div",Je,[y(" Resultado por p\xE1gina "),e(v,{options:[5,10,15],modelValue:i(r).rowsPerPage,"onUpdate:modelValue":[l[14]||(l[14]=t=>i(r).rowsPerPage=t),g],borderless:"",class:"q-ml-md"},null,8,["modelValue"])]),e(ce,{modelValue:i(r).page,"onUpdate:modelValue":[l[15]||(l[15]=t=>i(r).page=t),g],max:s.orders.meta.last_page,"direction-links":"","boundary-links":"",color:"grey",input:"","icon-first":"keyboard_double_arrow_left","icon-last":"keyboard_double_arrow_right"},null,8,["modelValue","max"])])]),_:1})]),_:1})],64)}}};export{Xe as default};
