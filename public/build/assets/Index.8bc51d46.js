import{h as ue,u as b,j as M,m as S,n as H,a as e,b as i,w as a,F as me,r as c,o as m,H as fe,d as n,s as v,f as y,t as h,z as pe,c as p,q as ve,A as he}from"./app.cc606831.js";import{_ as be}from"./AuthenticatedLayout.0bc0b363.js";import{_ as ye}from"./DialogConfirm.f96873bf.js";import{_ as _e}from"./Summary.83229344.js";const qe={class:"row q-pb-sm"},ge={class:"column col-12 col-md-6 justify-center"},xe=n("div",{class:"app-fs-28 app-fw-700 app-lh-32 text-grey-8"}," Financeiro ",-1),Oe={class:"row justify-end"},we={class:"row items-center"},Ce={key:0,class:"row q-mb-lg"},ke={class:"col-12 flex justify-end items-end"},Me=n("div",{class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20"}," Adicionar Pedido ",-1),Se={class:"row q-col-gutter-sm"},Be={class:"col-12"},Ve={class:"col-12"},Te={class:"col-12"},Ie={class:"col-12"},Ne={class:"col-12"},Re={class:"text-red"},$e={class:"flex flex-center q-pt-lg q-pa-md q-gutter-sm"},ze=n("div",{class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20"}," Filtrar ",-1),Pe=n("div",{class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20 m-4"}," Limpar ",-1),Fe=["onClick"],Ae={class:"flex flex-center app-fw-700 app-fs-16"},Ee={class:"app-fw-700 app-fs-16"},Ue=n("div",{class:"q-ml-sm"}," Editar pedido ",-1),je=n("div",{class:"q-ml-sm"}," Visualizar pedido ",-1),Le=n("div",{class:"q-ml-sm"}," Cancelar recorr\xEAncia ",-1),De=n("div",{class:"q-ml-sm"}," Visualizar ",-1),Ye={class:"row justify-end"},He={class:"row items-center text-grey"},We={__name:"Index",props:{orders:Object,errors:Object,query:Object,paymentMethods:Object,statuses:Object,campaigns:Object,students:Array,ordersPaidCount:Number,ordersExpiredCount:Number,ordersCanceledCount:Number,ordersNotRenewedCount:Number,churnRateThisMonth:Number,churnRateLastMonth:Number,differenceInChurnRates:Number,canOrderCancel:Boolean,canOrderUpdate:Boolean,canOrderStore:Boolean,valueOfOrdersCanceledInSelectedMonth:Number,valueOfOrdersCanceledInTheMonthBeforeSelectedMonth:Number,valueOfOrdersExpiredInSelectedMonth:Number,valueOfOrdersExpiredInTheMonthBeforeSelectedMonth:Number,valueOfOrdersToBeReceivedInSelectedMonth:Number,valueOfOrdersToBeReceivedInTheMonthBeforeSelectedMonth:Number,valueOfOrdersToBeReceivedToday:Number,valueOfOrdersToBeReceivedYesterday:Number,selectedMonth:Number},setup(o){const d=o,R=ue(),J=[{name:"student_id",align:"left",label:"ID do aluno",field:s=>s.student.id,style:"width: 5%"},{name:"student_name",align:"left",label:"Nome do aluno",field:s=>s.student.name,style:"width: 20%"},{name:"student_email",align:"left",label:"E-mail do aluno",field:s=>s.student.email,style:"width: 25%"},{name:"registration_type",align:"left",label:"Tipo de cadastro",field:s=>s.registration_type.replace(/^./,l=>l.toUpperCase()),style:"width: 15%"},{name:"payment_method",align:"left",label:"Forma de pagamento",field:s=>ee(s.payment_method),style:"width: 25%"},{name:"status",align:"left",label:"Status",field:"status",style:"width: 10%"},{name:"actions",label:"A\xE7\xE3o"}],r=b({orderBy:d.query.orderBy,sort:d.query.sort,page:d.query.page,rowsPerPage:d.query.rowsPerPage,filters:{payment_method:d.query.filters.payment_method,status:d.query.filters.status,hiring_start_at:d.query.filters.hiring_start_at,campaign_id:d.query.filters.campaign_id,student_id:d.query.filters.student_id,email:d.query.filters.email}}),K=s=>{r.orderBy===s?r.sort=r.sort=="desc"?"asc":"desc":r.sort=="asc",r.orderBy=s,r.page=1,q()},_=s=>{r.filters[s]=null,q()},q=()=>{r.get(route("admin.financial.index"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>B.value=!1})},Q=s=>{R.dialog({component:ye,componentProps:{title:"Cancelar recorr\xEAncia?",message:"Tem certeza que deseja cancelar recorr\xEAncia?"}}).onOk(()=>{b().post(route("admin.order.cancel",s),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{R.notify({type:"positive",message:"Recorr\xEAncia cancelada com sucesso",position:"top"})}})})},G=()=>b().get(route("admin.order.create")),W=s=>b().get(route("admin.order.edit",s)),$=s=>b().get(route("admin.order.show",s)),z=M(()=>Object.values(d.query.filters).filter(s=>s).length),B=S(!1),P=M(()=>{let s=new Array;for(const l in d.paymentMethods)s.push({label:d.paymentMethods[l],value:l});return s}),F=M(()=>{let s=new Array;for(const l in d.statuses)s.push({label:d.statuses[l],value:l});return s}),A=S(d.campaigns),X=(s,l,C)=>{l(()=>A.value=d.campaigns.filter(w=>w.name.toLowerCase().indexOf(s.toLowerCase())>-1))},E=S(d.students),Z=(s,l,C)=>{l(()=>E.value=d.students.filter(w=>w.name.toLowerCase().indexOf(s.toLowerCase())>-1))},ee=s=>d.paymentMethods[s],te=s=>d.statuses[s],ae=s=>{switch(s){case"adimplente":return"adm-bg-positive";case"cancelado":return"adm-bg-error";case"nao_renovou":return"adm-bg-negative";case"vencido":return"adm-bg-caution";default:return"bg-white"}},le=M(()=>[{value:1,label:"Janeiro"},{value:2,label:"Fevereiro"},{value:3,label:"Mar\xE7o"},{value:4,label:"Abril"},{value:5,label:"Maio"},{value:6,label:"Junho"},{value:7,label:"Julho"},{value:8,label:"Agosto"},{value:9,label:"Setembro"},{value:10,label:"Outubro"},{value:11,label:"Novembro"},{value:12,label:"Dezembro"}]),V=S(d.selectedMonth),se=()=>{b({month:V.value}).get(route("admin.financial.index"),{preserveState:!0,preserveScroll:!0})},oe=()=>b().get(route("admin.financial.index"));return(s,l)=>{const C=c("q-breadcrumbs-el"),w=c("q-breadcrumbs"),g=c("q-select"),u=c("q-icon"),x=c("q-btn"),f=c("q-chip"),k=c("q-card-section"),U=c("q-card"),j=c("q-input"),ne=c("q-space"),re=c("q-badge"),L=c("q-menu"),T=c("q-separator"),D=c("q-th"),Y=c("q-td"),I=c("q-item-section"),N=c("q-item"),ie=c("q-list"),de=c("q-table"),ce=c("q-pagination");return m(),H(me,null,[e(i(fe),{title:"Financeiro"}),e(be,null,{default:a(()=>[n("div",qe,[n("div",ge,[xe,e(w,{class:"text-grey q-mt-sm app-fs-13 app-fw-400 app-lh-16",gutter:"xs"},{default:a(()=>[e(C,{label:"Home",class:"text-grey"}),e(C,{label:"Financeiro",class:"text-primary"})]),_:1})])]),n("div",Oe,[n("div",we,[e(g,{options:i(le),borderless:"","emit-value":"","map-options":"",modelValue:V.value,"onUpdate:modelValue":[l[0]||(l[0]=t=>V.value=t),se],class:"q-mr-sm"},null,8,["options","modelValue"])])]),e(_e,{valueOfOrdersCanceledInSelectedMonth:o.valueOfOrdersCanceledInSelectedMonth,valueOfOrdersCanceledInTheMonthBeforeSelectedMonth:o.valueOfOrdersCanceledInTheMonthBeforeSelectedMonth,valueOfOrdersExpiredInSelectedMonth:o.valueOfOrdersExpiredInSelectedMonth,valueOfOrdersExpiredInTheMonthBeforeSelectedMonth:o.valueOfOrdersExpiredInTheMonthBeforeSelectedMonth,valueOfOrdersToBeReceivedInSelectedMonth:o.valueOfOrdersToBeReceivedInSelectedMonth,valueOfOrdersToBeReceivedInTheMonthBeforeSelectedMonth:o.valueOfOrdersToBeReceivedInTheMonthBeforeSelectedMonth,valueOfOrdersToBeReceivedToday:o.valueOfOrdersToBeReceivedToday,valueOfOrdersToBeReceivedYesterday:o.valueOfOrdersToBeReceivedYesterday},null,8,["valueOfOrdersCanceledInSelectedMonth","valueOfOrdersCanceledInTheMonthBeforeSelectedMonth","valueOfOrdersExpiredInSelectedMonth","valueOfOrdersExpiredInTheMonthBeforeSelectedMonth","valueOfOrdersToBeReceivedInSelectedMonth","valueOfOrdersToBeReceivedInTheMonthBeforeSelectedMonth","valueOfOrdersToBeReceivedToday","valueOfOrdersToBeReceivedYesterday"]),o.canOrderStore?(m(),H("div",Ce,[n("div",ke,[e(x,{color:"primary",rounded:"","no-caps":"",onClick:G},{default:a(()=>[e(u,{name:"add",size:"xs"}),Me]),_:1})])])):v("",!0),e(U,{flat:"",class:"app-br-16 q-pa-md q-mb-lg"},{default:a(()=>[e(k,{class:"flex flex-center q-py-sm"},{default:a(()=>[e(f,{class:"adm-bg-positive","text-color":"white"},{default:a(()=>[y(h(o.ordersPaidCount)+" Adimplentes ",1)]),_:1}),e(f,{class:"adm-bg-caution","text-color":"white"},{default:a(()=>[y(h(o.ordersExpiredCount)+" Vencidos ",1)]),_:1}),e(f,{class:"adm-bg-error","text-color":"white"},{default:a(()=>[y(h(o.ordersCanceledCount)+" Cancelados ",1)]),_:1}),e(f,{class:"adm-bg-negative","text-color":"white"},{default:a(()=>[y(h(o.ordersNotRenewedCount)+" N\xE3o renovados ",1)]),_:1})]),_:1})]),_:1}),e(U,{flat:"",class:"app-br-16 q-pa-sm q-mb-lg"},{default:a(()=>[e(k,{class:"row items-center q-py-sm q-px-lg"},{default:a(()=>[e(j,{outlined:"",modelValue:i(r).filters.email,"onUpdate:modelValue":l[1]||(l[1]=t=>i(r).filters.email=t),label:"Pesquisar por e-mail",dense:"",class:"q-mr-sm",onKeydown:pe(he(q,["prevent"]),["enter"])},{prepend:a(()=>[e(u,{name:"search",size:"xs"})]),_:1},8,["modelValue","onKeydown"]),o.query.filters.email?(m(),p(f,{key:0,class:"adm-chip-primary",label:`E-mail cont\xE9m '${o.query.filters.email}'`},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:l[2]||(l[2]=t=>_("email")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):v("",!0),o.query.filters.student_id?(m(),p(f,{key:1,class:"adm-chip-primary",label:`Aluno = ${o.students.filter(t=>t.id==o.query.filters.student_id).shift().name}`},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:l[3]||(l[3]=t=>_("student_id")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):v("",!0),o.query.filters.status?(m(),p(f,{key:2,class:"adm-chip-primary",label:`Status = ${i(F).filter(t=>t.value==o.query.filters.status).shift().label}`},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:l[4]||(l[4]=t=>_("status")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):v("",!0),o.query.filters.campaign_id?(m(),p(f,{key:3,class:"adm-chip-primary",label:`Campanha = ${o.campaigns.filter(t=>t.id==o.query.filters.campaign_id).shift().name}`},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:l[5]||(l[5]=t=>_("campaign_id")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):v("",!0),o.query.filters.payment_method?(m(),p(f,{key:4,class:"adm-chip-primary",label:`Forma de pagamento = ${i(P).filter(t=>t.value==o.query.filters.payment_method).shift().label}`},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:l[6]||(l[6]=t=>_("payment_method")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):v("",!0),o.query.filters.hiring_start_at?(m(),p(f,{key:5,class:"adm-chip-primary",label:`Data da contrata\xE7\xE3o em = ${o.query.filters.hiring_start_at}`},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:l[7]||(l[7]=t=>_("hiring_start_at")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):v("",!0),e(ne),e(x,{round:"",dense:"",flat:"",color:"primary"},{default:a(()=>[i(z)?(m(),p(re,{key:0,color:"primary",floating:"",rounded:"",label:i(z)},null,8,["label"])):v("",!0),e(u,{name:"tune",class:"rotate-90"}),e(L,{style:{"min-width":"500px"},"max-width":"500px",class:"bg-white q-pa-md app-br-16",modelValue:B.value,"onUpdate:modelValue":l[13]||(l[13]=t=>B.value=t)},{default:a(()=>[n("div",Se,[n("div",Be,[e(g,{options:E.value,"option-value":"id","option-label":"name","emit-value":"","map-options":"",outlined:"",modelValue:i(r).filters.student_id,"onUpdate:modelValue":l[8]||(l[8]=t=>i(r).filters.student_id=t),label:"Aluno",clearable:"","use-chips":"","use-input":"",onFilter:Z},{"selected-item":a(t=>[e(f,{class:"adm-chip-primary q-my-none",label:t.opt.name,dense:""},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:O=>t.removeAtIndex(t.index),class:"q-ml-xs cursor-pointer"},null,8,["onClick"])]),_:2},1032,["label"])]),_:1},8,["options","modelValue"])]),n("div",Ve,[e(g,{options:i(F),outlined:"",modelValue:i(r).filters.status,"onUpdate:modelValue":l[9]||(l[9]=t=>i(r).filters.status=t),label:"Status","emit-value":"","map-options":"",clearable:""},null,8,["options","modelValue"])]),n("div",Te,[e(g,{options:i(P),outlined:"",modelValue:i(r).filters.payment_method,"onUpdate:modelValue":l[10]||(l[10]=t=>i(r).filters.payment_method=t),label:"Forma de pagamento","emit-value":"","map-options":"",clearable:""},null,8,["options","modelValue"])]),n("div",Ie,[e(g,{options:A.value,"option-value":"id","option-label":"name","emit-value":"","map-options":"",outlined:"",modelValue:i(r).filters.campaign_id,"onUpdate:modelValue":l[11]||(l[11]=t=>i(r).filters.campaign_id=t),label:"Campanha",clearable:"","use-chips":"","use-input":"",onFilter:X},{"selected-item":a(t=>[e(f,{class:"adm-chip-primary q-my-none",label:t.opt.name,dense:""},{default:a(()=>[e(u,{name:"cancel",size:"xs",onClick:O=>t.removeAtIndex(t.index),class:"q-ml-xs cursor-pointer"},null,8,["onClick"])]),_:2},1032,["label"])]),_:1},8,["options","modelValue"])]),n("div",Ne,[e(j,{outlined:"",modelValue:i(r).filters.hiring_start_at,"onUpdate:modelValue":l[12]||(l[12]=t=>i(r).filters.hiring_start_at=t),mask:"##/##/####",label:"Data da contrata\xE7\xE3o",placeholder:"dia/m\xEAs/ano","bottom-slots":Boolean(o.errors["filters.hiring_start_at"])},{hint:a(()=>[n("div",Re,h(o.errors["filters.hiring_start_at"]),1)]),prepend:a(()=>[e(u,{name:"o_calendar_today"})]),_:1},8,["modelValue","bottom-slots"])])]),n("div",$e,[e(x,{color:"primary",rounded:"","no-caps":"",onClick:q},{default:a(()=>[e(u,{name:"check",size:"xs"}),ze]),_:1}),e(x,{color:"primary",rounded:"",outline:"","no-caps":"",onClick:oe},{default:a(()=>[e(u,{name:"close",size:"xs"}),Pe]),_:1})])]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(k,{class:"q-py-none"},{default:a(()=>[e(T,{color:"grey-3"})]),_:1}),e(k,{class:"q-py-none"},{default:a(()=>[e(de,{rows:o.orders.data,columns:J,flat:"",class:"text-grey-8","hide-pagination":"",pagination:{rowsPerPage:i(r).rowsPerPage}},{"header-cell":a(t=>[e(D,{props:t},{default:a(()=>[n("div",{class:"app-fw-700 app-fs-16 cursor-pointer",onClick:O=>K(t.col.name)},[y(h(t.col.label)+" ",1),t.col.name===o.query.orderBy?(m(),p(u,{key:0,name:o.query.sort=="desc"?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["name"])):v("",!0)],8,Fe)]),_:2},1032,["props"])]),"header-cell-actions":a(t=>[e(D,{props:t,"auto-width":""},{default:a(()=>[n("div",Ae,h(t.col.label),1)]),_:2},1032,["props"])]),"body-cell-status":a(t=>[e(Y,{props:t},{default:a(()=>[e(f,{"text-color":"white",class:ve(ae(t.row.status))},{default:a(()=>[y(h(te(t.row.status)),1)]),_:2},1032,["class"])]),_:2},1032,["props"])]),"body-cell-actions":a(t=>[e(Y,{props:t},{default:a(()=>[n("div",Ee,[o.canOrderUpdate||o.canOrderCancel?(m(),p(x,{key:0,icon:"more_vert",flat:""},{default:a(()=>[e(L,null,{default:a(()=>[e(ie,null,{default:a(()=>[o.canOrderUpdate?(m(),p(N,{key:0,clickable:"",onClick:O=>W(t.row.id),class:"text-grey-7 flex items-center"},{default:a(()=>[e(u,{name:"edit",size:"xs"}),e(I,{"no-wrap":""},{default:a(()=>[Ue]),_:1})]),_:2},1032,["onClick"])):v("",!0),e(T),e(N,{clickable:"",onClick:O=>$(t.row.id),class:"text-grey-7 flex items-center"},{default:a(()=>[e(u,{name:"visibility",size:"xs"}),e(I,{"no-wrap":""},{default:a(()=>[je]),_:1})]),_:2},1032,["onClick"]),e(T),o.canOrderCancel?(m(),p(N,{key:1,clickable:"",onClick:O=>Q(t.row.id),class:"text-grey-7 flex flex-center"},{default:a(()=>[e(u,{name:"close",size:"xs"}),e(I,{"no-wrap":""},{default:a(()=>[Le]),_:1})]),_:2},1032,["onClick"])):v("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(m(),p(x,{key:1,onClick:O=>$(t.row.id),class:"text-grey-7 flex flex-center text-no-wrap",flat:"","no-caps":""},{default:a(()=>[e(u,{name:"visibility",size:"xs"}),De]),_:2},1032,["onClick"]))])]),_:2},1032,["props"])]),_:1},8,["rows","pagination"])]),_:1}),n("div",Ye,[n("div",He,[y(" Resultado por p\xE1gina "),e(g,{options:[5,10,15],modelValue:i(r).rowsPerPage,"onUpdate:modelValue":[l[14]||(l[14]=t=>i(r).rowsPerPage=t),q],borderless:"",class:"q-ml-md"},null,8,["modelValue"])]),e(ce,{modelValue:i(r).page,"onUpdate:modelValue":[l[15]||(l[15]=t=>i(r).page=t),q],max:o.orders.meta.last_page,"direction-links":"","boundary-links":"",color:"grey",input:"","icon-first":"keyboard_double_arrow_left","icon-last":"keyboard_double_arrow_right"},null,8,["modelValue","max"])])]),_:1})]),_:1})],64)}}};export{We as default};
