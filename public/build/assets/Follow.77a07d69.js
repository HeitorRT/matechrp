import{_ as fe}from"./AuthenticatedLayout.0bc0b363.js";import{h as ge,j as d,m as S,K as pe,c as h,w as u,l as g,k as he,r as p,o as n,a as l,b as c,H as ve,n as m,t as v,s as r,d as s,q as _e,p as H,F as P,u as x,f as be}from"./app.cc606831.js";import{_ as ye}from"./DialogConfirm.f96873bf.js";const Se={key:0,class:"bg-red app-br-16 text-white text-center q-py-sm q-mb-md"},qe={key:1,class:"bg-red app-br-16 text-white text-center q-py-sm q-mb-md"},we={class:"row q-mb-lg"},xe={class:"column col-12 col-md-6 justify-center"},ke={class:"app-fs-28 app-fw-700 app-lh-32 text-grey-8"},De={class:"col-12 col-md-6 flex justify-end items-center"},Ie=s("div",{class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20"}," Iniciar encontro ",-1),Te={class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20"},Me=s("div",{class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20"}," Finalizar encontro ",-1),Ce={class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20"},Fe={key:5,class:"q-mx-md text-red app-fw-600"},ze={class:"bg-white q-py-lg q-px-lg app-br-16"},$e={class:"row q-col-gutter-lg"},Ve={key:0,class:"col-12 col-md-12"},Ee=["title","src"],Oe=s("div",{class:"col-12 items-center q-mt-xs"},[s("div",{class:"q-ml-sm text-grey-8 app-fw-700 app-lh-32 app-fs-23"}," Alunos inscritos ")],-1),Ae={class:"col-12"},Be={key:1,class:"col-12 items-center q-mt-xs"},je=s("div",{class:"q-ml-sm text-grey-8 app-fw-700 app-lh-32 app-fs-23"}," Oferta ",-1),Ne=[je],Le={key:2,class:"col-12 col-md-5"},Ue={key:3,class:"col-12 col-md-7"},He={key:4,class:"col-12"},Pe={key:5,class:"col-12 items-center"},We=s("div",{class:"q-ml-sm text-grey-8 app-fw-700 app-lh-32 app-fs-23"}," Material ",-1),Ke=[We],Qe={class:"absolute-bottom text-subtitle2 row items-center"},Re={class:"column"},Ge={class:"text-caption"},Je={class:"text-caption"},tt={__name:"Follow",props:{meeting:Object,errors:Object,canMeetingStartFinish:Boolean,canMeetingDetachStudent:Boolean},setup(t){const o=t,b=ge(),W="https://i.pinimg.com/564x/04/54/7c/04547c2b354abb70a85ed8a2d1b33e5f.jpg",K=e=>{b.dialog({component:ye,componentProps:{title:"Retirar aluno",message:`Tem certeza que deseja retirar ${e.name} do encontro ${o.meeting.name}?`}}).onOk(()=>{x().put(route("admin.meeting.detach-student",{meeting:o.meeting.id,student:e.id}),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{b.notify({type:"positive",message:`${e.name} retirando do encontro ${o.meeting.name}.`,position:"top"})}})})},Q=()=>{x().put(route("admin.meeting.start",o.meeting.id),{preserveScroll:!0,onSuccess:()=>{b.notify({type:"positive",message:`Encontro ${o.meeting.name} iniciado.`,position:"top"}),E()}})},R=()=>{x().put(route("admin.meeting.finish",o.meeting.id),{preserveScroll:!0,onSuccess:()=>{b.notify({type:"positive",message:`Encontro ${o.meeting.name} finalizado.`,position:"top"})}})},G=()=>{x().put(route("admin.meeting.toggle-offer-availability",o.meeting.id),{preserveScroll:!0,onSuccess:()=>{let e=o.meeting.offer_available?"liberada":"encerrar";b.notify({type:"positive",message:`Oferta ${e}`,position:"top"})}})},J=e=>{const a=document.createElement("a");a.href=e.link,a.setAttribute("download",e.name),a.click()},F=()=>{let e=o.meeting.start_at.match(/(\d\d)\/(\d\d)\/(\d\d\d\d) (\d\d):(\d\d)/);const a=g.buildDate({year:e[3],month:e[2],day:e[1],hours:e[4],minutes:e[5],seconds:0});return g.getDateDiff(a,Date.now(),"seconds")};let X=setInterval(()=>{F()<=300&&(clearInterval(X),D.value=!0)},1e3);const z=d(()=>o.meeting.status==="Aberto"),q=d(()=>o.meeting.status==="Iniciado"),Y=d(()=>o.meeting.status==="Finalizado"),k=d(()=>o.meeting.status!=="Finalizado"),D=S(F()<=300),I=d(()=>o.meeting.teacher.id===he().props.value.auth.user.id),Z=d(()=>I.value&&D.value&&z.value),ee=d(()=>I.value&&q.value),te=d(()=>I.value&&!D.value&&z.value),$=()=>{if(!o.meeting.started_at)return 0;let e=o.meeting.started_at.match(/(\d\d)\/(\d\d)\/(\d\d\d\d) (\d\d):(\d\d):(\d\d)/),a=g.buildDate({year:e[3],month:e[2],day:e[1],hours:e[4],minutes:e[5],seconds:e[6]});return g.getDateDiff(Date.now(),a,"seconds")},T=S($()),ae=d(()=>T.value>0?new Date(T.value*1e3).toISOString().slice(11,19):"00:00:00"),V=S(),E=()=>{V.value=setInterval(()=>{q.value?T.value=$():clearInterval(V.value)},1e3)},O=()=>{let e=o.meeting.end_at.match(/(\d\d)\/(\d\d)\/(\d\d\d\d) (\d\d):(\d\d)/),a=g.buildDate({year:e[3],month:e[2],day:e[1],hours:e[4],minutes:e[5],seconds:0});return g.getDateDiff(a,Date.now(),"seconds")},f=S(O()),ne=d(()=>f.value>0?new Date(f.value*1e3).toISOString().slice(14,19):"00:00"),se=d(()=>f.value<300&&f.value>0&&k.value),oe=d(()=>f.value<=0&&k.value),A=d(()=>f.value<=0);let ie=setInterval(()=>{f.value=O(),f.value===0&&clearInterval(ie)},1e3);const B=()=>{let e=o.meeting.start_at.match(/(\d\d)\/(\d\d)\/(\d\d\d\d) (\d\d):(\d\d):(\d\d)/),a=g.buildDate({year:e[3],month:e[2],day:e[1],hours:e[4],minutes:e[5],seconds:e[6]});return g.getDateDiff(a,Date.now(),"seconds")-300},w=S(B()),le=d(()=>w.value>0?new Date(w.value*1e3).toISOString().slice(11,19):"00:00:00");let ce=setInterval(()=>{w.value=B(),w.value===0&&clearInterval(ce)},1e3);return pe(()=>{E()}),(e,a)=>{const M=p("q-breadcrumbs-el"),re=p("q-breadcrumbs"),_=p("q-icon"),y=p("q-btn"),de=p("q-chip"),C=p("q-input"),me=p("q-tooltip"),ue=p("q-img");return n(),h(fe,null,{default:u(()=>{var j,N;return[l(c(ve),{title:t.meeting.name},null,8,["title"]),c(se)?(n(),m("div",Se," Aten\xE7\xE3o: este encontro deve terminar em "+v(c(ne))+" minutos. ",1)):r("",!0),c(oe)?(n(),m("div",qe," Aten\xE7\xE3o: o prazo de encerramento deste encontro j\xE1 estourou. ")):r("",!0),s("div",we,[s("div",xe,[s("div",ke,v(t.meeting.name),1),l(re,{class:"text-grey q-mt-sm app-fs-13 app-fw-400 app-lh-16",gutter:"xs"},{default:u(()=>[l(M,{label:"Home",class:"text-grey"}),l(M,{label:"Encontros",class:"text-grey"}),l(M,{label:t.meeting.name,class:"text-primary"},null,8,["label"])]),_:1})]),s("div",De,[c(Z)?(n(),h(y,{key:0,color:"primary",class:"q-mr-md",rounded:"","no-caps":"",outline:"",onClick:a[0]||(a[0]=i=>Q())},{default:u(()=>[l(_,{name:"o_play_arrow",size:"xs"}),Ie]),_:1})):r("",!0),c(te)?(n(),h(y,{key:1,color:"primary",class:"q-mr-md cursor-inherit",rounded:"","no-caps":"",outline:""},{default:u(()=>[l(_,{name:"pan_tool",size:"xs"}),s("div",Te," Aguarde, voc\xEA poder\xE1 iniciar o encontro em "+v(c(le)),1)]),_:1})):r("",!0),c(ee)?(n(),h(y,{key:2,color:"negative",class:"q-mr-md",rounded:"","no-caps":"",outline:"",onClick:a[1]||(a[1]=i=>R())},{default:u(()=>[l(_,{name:"close",size:"xs"}),Me]),_:1})):r("",!0),c(q)&&t.meeting.has_live_offer?(n(),h(y,{key:3,color:t.meeting.offer_available?"warning":"primary",rounded:"","no-caps":"",onClick:G,unelevated:""},{default:u(()=>[l(_,{name:t.meeting.offer_available?"money_off":"attach_money",size:"xs"},null,8,["name"]),s("div",Ce,v(t.meeting.offer_available?"Encerrar oferta":"Liberar oferta"),1)]),_:1},8,["color"])):r("",!0),c(q)?(n(),m("div",{key:4,class:_e(["q-mx-md",{"text-primary":!c(A),"text-red":c(A)}])},v(c(ae)),3)):r("",!0),c(Y)?(n(),m("div",Fe," Finalizado ")):r("",!0)])]),s("div",ze,[s("div",$e,[(j=t.meeting.teacher)!=null&&j.whereby_link?(n(),m("div",Ve,[s("iframe",{title:`Aula de ${t.meeting.teacher.name}`,class:"adm-player-embed app-br-16",allowfullscreen:"",src:(N=t.meeting.teacher)==null?void 0:N.whereby_link,allow:"camera; microphone; fullscreen; speaker; display-capture"},`
                    `,8,Ee)])):r("",!0),Oe,s("div",Ae,[(n(!0),m(P,null,H(t.meeting.students,i=>(n(),h(de,{class:"adm-chip-primary",label:i.name},{default:u(()=>[t.canMeetingDetachStudent&&c(k)?(n(),h(_,{key:0,name:"cancel",size:"xs",class:"q-ml-xs cursor-pointer",onClick:L=>K(i)},null,8,["onClick"])):r("",!0)]),_:2},1032,["label"]))),256))]),t.meeting.has_live_offer?(n(),m("div",Be,Ne)):r("",!0),t.meeting.has_live_offer?(n(),m("div",Le,[l(C,{outlined:"",modelValue:t.meeting.name_offer,"onUpdate:modelValue":a[2]||(a[2]=i=>t.meeting.name_offer=i),label:"Nome da oferta",disable:""},null,8,["modelValue"])])):r("",!0),t.meeting.has_live_offer?(n(),m("div",Ue,[l(C,{outlined:"",modelValue:t.meeting.embed_offer,"onUpdate:modelValue":a[3]||(a[3]=i=>t.meeting.embed_offer=i),label:"Link da oferta",disable:""},null,8,["modelValue"])])):r("",!0),t.meeting.has_live_offer?(n(),m("div",He,[l(C,{outlined:"",modelValue:t.meeting.description_offer,"onUpdate:modelValue":a[4]||(a[4]=i=>t.meeting.description_offer=i),label:"Descri\xE7\xE3o da oferta",disable:""},null,8,["modelValue"])])):r("",!0),t.meeting.materials.length>0?(n(),m("div",Pe,Ke)):r("",!0),(n(!0),m(P,null,H(t.meeting.materials,(i,L)=>(n(),m("div",{class:"col-12 col-md-3",key:`material-${L}}}`},[l(ue,{src:i.is_image?i.link:W,style:{height:"240px"},class:"app-br-16"},{default:u(()=>{var U;return[s("div",Qe,[l(_,{name:"attach_file",size:"md",class:"rotate-225 q-mr-md"}),s("div",Re,[s("span",Ge,v(i.name.length>25?i.name.slice(0,25)+"...":i.name),1),s("span",Je," ("+v((U=i.size)!=null?U:0)+" kb) ",1)]),l(y,{color:"white",class:"absolute",style:{top:"8px",right:"8px"},flat:"",icon:"file_download",size:"md",onClick:Xe=>J(i),dense:""},{default:u(()=>[l(me,{anchor:"center left",self:"center right",offset:[10,10],class:"text-body2 bg-grey-10"},{default:u(()=>[be(" Clique para fazer o download ")]),_:1})]),_:2},1032,["onClick"])])]}),_:2},1032,["src"])]))),128))])])]}),_:1})}}};export{tt as default};
