import{h as ge,u as g,m as B,j as Y,c as p,w as l,r as c,i as be,o as m,a as t,b as r,H as ve,d as i,s as f,n as T,t as b,e as W,f as M,q as xe,p as we,F as he}from"./app.cc606831.js";import{_ as ke}from"./AuthenticatedLayout.0bc0b363.js";import{_ as E}from"./DialogConfirm.f96873bf.js";const Ve={class:"row q-pb-xl"},Ce={class:"column col-12 col-md-6 justify-center"},$e=i("div",{class:"app-fs-28 app-fw-700 app-lh-32 text-grey-8"}," Encontros ",-1),ze={class:"col-12 col-md-6 flex justify-end items-center"},Me=i("div",{class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20"}," Excluir selecionados ",-1),De=i("div",{class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20"}," Novo encontro ",-1),Se={class:"row q-col-gutter-sm"},Pe={class:"col-12"},je={class:"col-12"},Ue={class:"col-12"},Be={key:0,class:"col-12"},Ye={class:"col-12"},Te={class:"text-red"},Ee={class:"row items-center justify-end"},Oe={class:"col-12"},He={class:"text-red"},Fe={class:"row items-center justify-end"},Ie={class:"flex flex-center q-pt-lg q-pa-md q-gutter-sm"},Ae=i("div",{class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20"}," Filtrar ",-1),Ne=i("div",{class:"q-ml-sm app-fw-500 app-fs-14 app-lh-20 m-4"}," Limpar ",-1),Le=["onClick"],Re={class:"flex flex-center app-fw-700 app-fs-16"},Qe={class:"row items-center justify-center app-fw-700 app-fs-16"},Ge=i("div",{class:"q-ml-sm"}," Editar ",-1),Je=i("div",{class:"q-ml-sm"}," Visualizar ",-1),Ke=i("div",{class:"q-ml-sm"}," Excluir ",-1),We=i("div",{class:"q-ml-sm"}," Acompanhar ",-1),Xe=i("div",{class:"q-ml-sm"}," Visualizar ",-1),Ze={class:"row items-center text-grey"},et={class:"row items-center text-grey"},at={__name:"Index",props:{meetings:Object,errors:Object,query:Object,types:Object,status:Object,teachers:Array,canMeetingStore:Boolean,canMeetingEdit:Boolean,canMeetingDestroy:Boolean,canMeetingDetachStudent:Boolean,canMeetingIndividualView:Boolean},setup(o){const u=o,v=ge(),X=[{name:"name",align:"left",label:"Nome do encontro",field:"name",style:"width: 20%"},{name:"status",align:"center",label:"Status",style:"width: 10%"},{name:"type",align:"left",label:"Tipo",field:"type",style:"width: 10%"},{name:"teacher_name",align:"left",label:"Professor",field:a=>a.teacher.name,style:"width: 20%"},{name:"students",align:"left",label:"Alunos inscritos",field:"students",style:"width: 10%"},{name:"start_at",align:"left",label:"In\xEDcio",field:"start_at",style:"width: 10%"},{name:"end_at",align:"left",label:"T\xE9rmino",field:"end_at",style:"width: 10%"},{name:"actions",label:"A\xE7\xE3o"}],n=g({orderBy:u.query.orderBy,sort:u.query.sort,page:u.query.page,rowsPerPage:u.query.rowsPerPage,filters:{name:u.query.filters.name,status:u.query.filters.status,type:u.query.filters.type,teacher_id:u.query.filters.teacher_id?parseInt(u.query.filters.teacher_id):null,start_at:u.query.filters.start_at,end_at:u.query.filters.end_at}}),Z=a=>{n.orderBy===a?n.sort=n.sort=="desc"?"asc":"desc":n.sort=="asc",n.orderBy=a,n.page=1,w()},x=a=>{n.filters[a]=null,w()},w=()=>{n.get(route("admin.meeting.index"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>D.value=!1})},ee=(a,s)=>{v.dialog({component:E,componentProps:{title:"Retirar aluno",message:`Tem certeza que deseja retirar ${s.name} do encontro ${a.name}?`}}).onOk(()=>{g().put(route("admin.meeting.detach-student",{meeting:a.id,student:s.id}),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{v.notify({type:"positive",message:`${s.name} retirando do encontro ${a.name}.`,position:"top"})}})})},te=()=>g().get(route("admin.meeting.create")),le=a=>g().get(route("admin.meeting.edit",a)),O=a=>g().get(route("admin.meeting.show",a)),se=a=>g().get(route("admin.meeting.follow",a)),ae=a=>{v.dialog({component:E,componentProps:{title:"Excluir encontro",message:a.students.length>0?`H\xE1 ${a.students.length} alunos agendados para o encontro, ao excluir, os agendamentos ser\xE3o exclu\xEDdos. Tem certeza que deseja excluir esse encontro?`:"Tem certeza que deseja excluir esse encontro?"}}).onOk(()=>{g().delete(route("admin.meeting.destroy",a.id),{onSuccess:()=>{v.notify({type:"positive",message:"Encontro exclu\xEDdo com sucesso",position:"top"})}})})},oe=()=>{v.dialog({component:E,componentProps:{title:"Excluir selecionados",message:"Tem certeza que deseja excluir encontros selecionados?"}}).onOk(()=>{g({ids:h.value.map(a=>a.id)}).post(route("admin.meeting.destroy-multiples"),{onSuccess:()=>{h.value=[],v.notify({type:"positive",message:"Encontros exclu\xEDdos com sucesso",position:"top"})}})})},h=B([]),H=Y(()=>Object.values(u.query.filters).filter(a=>a).length),D=B(!1),F=B(u.teachers),ne=(a,s,S)=>{s(()=>F.value=u.teachers.filter(P=>P.name.toLowerCase().indexOf(a.toLowerCase())>-1))},re=Y(()=>{let a=new Array;for(const s in u.types)a.push({label:u.types[s],value:s});return a}),ie=Y(()=>{let a=new Array;for(const s in u.status)a.push({label:u.status[s],value:s});return a}),ce=a=>u.types[a],de=a=>{switch(a){case"agendamento":return"o_calendar_today";case"grupo":return"sym_o_group";case"extra":return"info";case"imersao":return"o_headset";case"individual":return"person_outline";default:return""}},ue=()=>g().get(route("admin.meeting.index")),me=a=>a==="Aberto"?"text-grey":a==="Iniciado"?"text-green":"text-red";return(a,s)=>{const S=c("q-breadcrumbs-el"),P=c("q-breadcrumbs"),d=c("q-icon"),y=c("q-btn"),q=c("q-chip"),I=c("q-space"),pe=c("q-badge"),j=c("q-input"),V=c("q-select"),A=c("q-date"),N=c("q-time"),L=c("q-popup-proxy"),R=c("q-menu"),U=c("q-card-section"),C=c("q-separator"),Q=c("q-checkbox"),G=c("q-th"),k=c("q-td"),$=c("q-item-section"),z=c("q-item"),fe=c("q-list"),_e=c("q-table"),ye=c("q-pagination"),qe=c("q-card"),J=be("close-popup");return m(),p(ke,null,{default:l(()=>[t(r(ve),{title:"Encontros"}),i("div",Ve,[i("div",Ce,[$e,t(P,{class:"text-grey q-mt-sm app-fs-13 app-fw-400 app-lh-16",gutter:"xs"},{default:l(()=>[t(S,{label:"Home",class:"text-grey"}),t(S,{label:"Encontros",class:"text-primary"})]),_:1})]),i("div",ze,[h.value.length>0&&o.canMeetingDestroy?(m(),p(y,{key:0,color:"negative",class:"q-mr-md",rounded:"","no-caps":"",outline:"",onClick:oe},{default:l(()=>[t(d,{name:"close",size:"xs"}),Me]),_:1})):f("",!0),o.canMeetingStore?(m(),p(y,{key:1,color:"primary",rounded:"","no-caps":"",onClick:te},{default:l(()=>[t(d,{name:"add",size:"xs"}),De]),_:1})):f("",!0)])]),t(qe,{flat:"",class:"app-br-16"},{default:l(()=>[t(U,{class:"row items-center q-py-sm q-px-lg"},{default:l(()=>[o.query.filters.name?(m(),p(q,{key:0,class:"adm-chip-primary",label:`Nome = ${o.query.filters.name}`},{default:l(()=>[t(d,{name:"cancel",size:"xs",onClick:s[0]||(s[0]=e=>x("name")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):f("",!0),o.query.filters.type?(m(),p(q,{key:1,class:"adm-chip-primary",label:`Tipo = ${o.types[o.query.filters.type]}`},{default:l(()=>[t(d,{name:"cancel",size:"xs",onClick:s[1]||(s[1]=e=>x("type")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):f("",!0),o.query.filters.teacher_id&&!o.canMeetingIndividualView?(m(),p(q,{key:2,class:"adm-chip-primary",label:`Professor = ${o.teachers.filter(e=>e.id==o.query.filters.teacher_id).shift().name}`},{default:l(()=>[t(d,{name:"cancel",size:"xs",onClick:s[2]||(s[2]=e=>x("teacher_id")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):f("",!0),o.query.filters.start_at?(m(),p(q,{key:3,class:"adm-chip-primary",label:`Inicio = ${o.query.filters.start_at}`},{default:l(()=>[t(d,{name:"cancel",size:"xs",onClick:s[3]||(s[3]=e=>x("start_at")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):f("",!0),o.query.filters.end_at?(m(),p(q,{key:4,class:"adm-chip-primary",label:`Termina = ${o.query.filters.end_at}`},{default:l(()=>[t(d,{name:"cancel",size:"xs",onClick:s[4]||(s[4]=e=>x("end_at")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):f("",!0),o.query.filters.status?(m(),p(q,{key:5,class:"adm-chip-primary",label:`Status = ${o.query.filters.status.map(e=>o.status[e]).join(", ")}`},{default:l(()=>[t(d,{name:"cancel",size:"xs",onClick:s[5]||(s[5]=e=>x("status")),class:"q-ml-xs cursor-pointer"})]),_:1},8,["label"])):f("",!0),t(I),t(y,{round:"",dense:"",flat:"",color:"primary"},{default:l(()=>[r(H)?(m(),p(pe,{key:0,color:"primary",floating:"",rounded:"",label:r(H)},null,8,["label"])):f("",!0),t(d,{name:"tune",class:"rotate-90"}),t(R,{style:{"min-width":"500px"},"max-width":"500px",class:"bg-white q-pa-md app-br-16",modelValue:D.value,"onUpdate:modelValue":s[16]||(s[16]=e=>D.value=e)},{default:l(()=>[i("div",Se,[i("div",Pe,[t(j,{outlined:"",modelValue:r(n).filters.name,"onUpdate:modelValue":s[6]||(s[6]=e=>r(n).filters.name=e),label:"Nome do encontro"},null,8,["modelValue"])]),i("div",je,[t(V,{options:r(ie),"emit-value":"","map-options":"",outlined:"",modelValue:r(n).filters.status,"onUpdate:modelValue":s[7]||(s[7]=e=>r(n).filters.status=e),label:"Status do encontro",multiple:""},null,8,["options","modelValue"])]),i("div",Ue,[t(V,{options:r(re),"emit-value":"","map-options":"",outlined:"",modelValue:r(n).filters.type,"onUpdate:modelValue":s[8]||(s[8]=e=>r(n).filters.type=e),label:"Tipo"},null,8,["options","modelValue"])]),o.canMeetingIndividualView?f("",!0):(m(),T("div",Be,[t(V,{options:F.value,"option-value":"id","option-label":"name","emit-value":"","map-options":"",outlined:"",modelValue:r(n).filters.teacher_id,"onUpdate:modelValue":s[9]||(s[9]=e=>r(n).filters.teacher_id=e),label:"Professor",clearable:"","use-input":"",onFilter:ne},{"selected-item":l(e=>[t(q,{class:"adm-chip-primary q-my-none",label:e.opt.name,dense:""},{default:l(()=>[t(d,{name:"cancel",size:"xs",onClick:_=>e.removeAtIndex(e.index),class:"q-ml-xs cursor-pointer"},null,8,["onClick"])]),_:2},1032,["label"])]),_:1},8,["options","modelValue"])])),i("div",Ye,[t(j,{outlined:"",modelValue:r(n).filters.start_at,"onUpdate:modelValue":s[12]||(s[12]=e=>r(n).filters.start_at=e),mask:"##/##/#### ##:##",label:"Data e hora de inicio","bottom-slots":Boolean(o.errors["filters.start_at"]),clearable:""},{prepend:l(()=>[t(d,{name:"o_calendar_today"})]),hint:l(()=>[i("div",Te,b(o.errors["filters.start_at"]),1)]),default:l(()=>[t(L,{class:"row"},{default:l(()=>[t(A,{modelValue:r(n).filters.start_at,"onUpdate:modelValue":s[10]||(s[10]=e=>r(n).filters.start_at=e),mask:"DD/MM/YYYY HH:mm",flat:"",square:""},null,8,["modelValue"]),t(N,{modelValue:r(n).filters.start_at,"onUpdate:modelValue":s[11]||(s[11]=e=>r(n).filters.start_at=e),mask:"DD/MM/YYYY HH:mm",format24h:"",flat:"",square:""},{default:l(()=>[i("div",Ee,[W(t(y,{label:"Ok",color:"primary",flat:""},null,512),[[J]])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","bottom-slots"])]),i("div",Oe,[t(j,{outlined:"",modelValue:r(n).filters.end_at,"onUpdate:modelValue":s[15]||(s[15]=e=>r(n).filters.end_at=e),mask:"##/##/#### ##:##",label:"Data e hora de t\xE9rmino","bottom-slots":Boolean(o.errors["filters.end_at"]),clearable:""},{prepend:l(()=>[t(d,{name:"o_calendar_today"})]),hint:l(()=>[i("div",He,b(o.errors["filters.end_at"]),1)]),default:l(()=>[t(L,{class:"row"},{default:l(()=>[t(A,{modelValue:r(n).filters.end_at,"onUpdate:modelValue":s[13]||(s[13]=e=>r(n).filters.end_at=e),mask:"DD/MM/YYYY HH:mm",flat:"",square:""},null,8,["modelValue"]),t(N,{modelValue:r(n).filters.end_at,"onUpdate:modelValue":s[14]||(s[14]=e=>r(n).filters.end_at=e),mask:"DD/MM/YYYY HH:mm",format24h:"",flat:"",square:""},{default:l(()=>[i("div",Fe,[W(t(y,{label:"Ok",color:"primary",flat:""},null,512),[[J]])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","bottom-slots"])])]),i("div",Ie,[t(y,{color:"primary",rounded:"","no-caps":"",onClick:w},{default:l(()=>[t(d,{name:"check",size:"xs"}),Ae]),_:1}),t(y,{color:"primary",rounded:"",outline:"","no-caps":"",onClick:ue},{default:l(()=>[t(d,{name:"close",size:"xs"}),Ne]),_:1})])]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(U,{class:"q-py-none"},{default:l(()=>[t(C,{color:"grey-3"})]),_:1}),t(U,{class:"q-py-none"},{default:l(()=>[t(_e,{rows:o.meetings.data,columns:X,flat:"",class:"text-grey-8",selected:h.value,"onUpdate:selected":s[17]||(s[17]=e=>h.value=e),selection:"multiple","hide-pagination":"",pagination:{rowsPerPage:r(n).rowsPerPage}},{"header-selection":l(e=>[t(Q,{modelValue:e.selected,"onUpdate:modelValue":_=>e.selected=_},null,8,["modelValue","onUpdate:modelValue"])]),"body-selection":l(e=>[t(Q,{"model-value":e.selected,"onUpdate:modelValue":(_,K)=>{Object.getOwnPropertyDescriptor(e,"selected").set(_,K)}},null,8,["model-value","onUpdate:modelValue"])]),"header-cell":l(e=>[t(G,{props:e},{default:l(()=>[i("div",{class:"app-fw-700 app-fs-16 cursor-pointer",onClick:_=>Z(e.col.name)},[M(b(e.col.label)+" ",1),e.col.name===o.query.orderBy?(m(),p(d,{key:0,name:o.query.sort=="desc"?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["name"])):f("",!0)],8,Le)]),_:2},1032,["props"])]),"header-cell-actions":l(e=>[t(G,{props:e,"auto-width":""},{default:l(()=>[i("div",Re,b(e.col.label),1)]),_:2},1032,["props"])]),"body-cell-type":l(e=>[t(k,{props:e},{default:l(()=>[t(d,{name:de(e.row.type),size:"sm",class:"q-mr-sm"},null,8,["name"]),M(" "+b(ce(e.row.type)),1)]),_:2},1032,["props"])]),"body-cell-status":l(e=>[t(k,{props:e},{default:l(()=>[i("div",{class:xe([me(e.row.status),"app-fw-500"])},b(e.row.status),3)]),_:2},1032,["props"])]),"body-cell-teacher_name":l(e=>[t(k,{props:e},{default:l(()=>[t(q,{class:"adm-chip-primary"},{default:l(()=>[M(b(e.row.teacher.name),1)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-students":l(e=>[t(k,{props:e},{default:l(()=>[(m(!0),T(he,null,we(e.row.students,_=>(m(),T("div",null,[t(q,{class:"adm-chip-primary",label:_.name},{default:l(()=>[o.canMeetingDetachStudent&&e.row.status!="Finalizado"?(m(),p(d,{key:0,name:"cancel",size:"xs",class:"q-ml-xs cursor-pointer",onClick:K=>ee(e.row,_)},null,8,["onClick"])):f("",!0)]),_:2},1032,["label"])]))),256))]),_:2},1032,["props"])]),"body-cell-actions":l(e=>[t(k,{props:e},{default:l(()=>[i("div",Qe,[(o.canMeetingEdit||o.canMeetingDestroy)&&e.row.status!=="Finalizado"?(m(),p(y,{key:0,icon:"more_vert",flat:""},{default:l(()=>[t(R,{offset:[65,0]},{default:l(()=>[t(fe,null,{default:l(()=>[o.canMeetingEdit?(m(),p(z,{key:0,clickable:"",onClick:_=>le(e.row.id),class:"text-grey-7 flex items-center"},{default:l(()=>[t(d,{name:"edit",size:"xs"}),t($,{"no-wrap":""},{default:l(()=>[Ge]),_:1})]),_:2},1032,["onClick"])):f("",!0),t(C),t(z,{clickable:"",onClick:_=>O(e.row.id),class:"text-grey-7 flex items-center"},{default:l(()=>[t(d,{name:"visibility",size:"xs"}),t($,{"no-wrap":""},{default:l(()=>[Je]),_:1})]),_:2},1032,["onClick"]),t(C),o.canMeetingDestroy?(m(),p(z,{key:1,clickable:"",onClick:_=>ae(e.row),class:"text-grey-7 flex flex-center"},{default:l(()=>[t(d,{name:"close",size:"xs"}),t($,{"no-wrap":""},{default:l(()=>[Ke]),_:1})]),_:2},1032,["onClick"])):f("",!0),t(C),t(z,{clickable:"",onClick:_=>se(e.row.id),class:"text-grey-7 flex flex-center"},{default:l(()=>[t(d,{name:"live_tv",size:"xs"}),t($,{"no-wrap":""},{default:l(()=>[We]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)):(m(),p(y,{key:1,onClick:_=>O(e.row.id),class:"text-grey-7 flex flex-center",flat:"","no-caps":""},{default:l(()=>[t(d,{name:"visibility",size:"xs"}),Xe]),_:2},1032,["onClick"]))])]),_:2},1032,["props"])]),_:1},8,["rows","selected","pagination"]),i("div",Ze,[t(I),i("div",et,[M(" Resultado por p\xE1gina "),t(V,{options:[5,10,15],modelValue:r(n).rowsPerPage,"onUpdate:modelValue":[s[18]||(s[18]=e=>r(n).rowsPerPage=e),w],borderless:"",class:"q-ml-md"},null,8,["modelValue"])]),t(ye,{modelValue:r(n).page,"onUpdate:modelValue":[s[19]||(s[19]=e=>r(n).page=e),w],max:o.meetings.meta.last_page,"direction-links":"","boundary-links":"",color:"grey",input:"","icon-first":"keyboard_double_arrow_left","icon-last":"keyboard_double_arrow_right"},null,8,["modelValue","max"])])]),_:1})]),_:1})]),_:1})}}};export{at as default};
